{% extends "base.html" %}
{% load static %}
{% block title %}Jobs{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'jobs.css' %}">
{% endblock %}

{% block content %}

<div class="jobs-header">
  <div>
    <h4 class="mb-0">Jobs</h4>
    <h6 class="mt-0">Find your next opportunity</h6>
  </div>

  {% if user.is_authenticated and user.role == "recruiter" %}
    <div class="d-flex gap-2">
      <a href="{% url 'create_job' %}" class="job-pill primary">
        + Post Job
      </a>
      <a href="{% url 'recruiter_dashboard' %}" class="job-pill outline">
        Dashboard
      </a>
    </div>
  {% endif %}
</div>

{% for job in jobs %}
  <div class="job-card">

    <!-- LEFT -->
    <div class="job-info">
      <h6 class="job-title">{{ job.title }}</h6>
      <p class="job-company">
        {{ job.company }} Â· {{ job.location }}
      </p>
      <small class="job-time">
        Posted {{ job.created_at|timesince }} ago
      </small>
    </div>

    <!-- RIGHT -->
    <div class="job-actions">
          
       {% if user.is_authenticated and user.role in "student professional recruiter" %}
    <a href="{% url 'job_detail' job.id %}" class="job-btn view">
      Apply
    </a>
  {% elif not user.is_authenticated %}
    <a href="{% url 'job_detail' job.id %}" class="job-btn view">
      View
    </a>
  {% endif %}
      {% if user.is_authenticated and user.role == "recruiter" and job.posted_by == user %}
        <a href="{% url 'job_applicants' job.id %}" class="job-btn applicants">
          Applicants
        </a>

        <form method="post"
              action="{% url 'delete_job' job.id %}"
              class="delete-form">
          {% csrf_token %}
          <button type="button"
                  class="job-btn delete"
                  onclick="confirmDelete(this)">
            Delete
          </button>
        </form>
      {% endif %}
    </div>

  </div>
{% empty %}
  <p class="text-muted text-center mt-4">
    No jobs posted yet.
  </p>
{% endfor %}

{% endblock %}
